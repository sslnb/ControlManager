<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
	<meta charset="utf-8">
	<title>重庆擎华科技数据采集系统</title>
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta http-equiv="Access-Control-Allow-Origin" content="*">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no">
	<link rel="icon" href="favicon.ico">
	<link rel="stylesheet" th:href="@{/static/layui/css/layui.css}" />
	<link rel="stylesheet" th:href="@{/static/css/main.css}" />
	<!--[if lt IE 9]>
	<script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
	<script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
	<![endif]-->
</head>
<body class="main_body">
	<div class="layui-layout layui-layout-admin">
		<!-- 顶部 -->
		<div class="layui-header header">
			<div class="layui-main">
				<a href="#" class="logo" style="font-size: inherit">重庆擎华数据采集系统</a>
				<!-- 显示/隐藏菜单 -->
				<a href="javascript:;" class="iconfont hideMenu layui-icon-senior"></a>

			    <!-- 天气信息 -->
			    <div class="weather" pc>
			    	<div id="tp-weather-widget"></div>
					<script>(function(T,h,i,n,k,P,a,g,e){g=function(){P=h.createElement(i);a=h.getElementsByTagName(i)[0];P.src=k;P.charset="utf-8";P.async=1;a.parentNode.insertBefore(P,a)};T["ThinkPageWeatherWidgetObject"]=n;T[n]||(T[n]=function(){(T[n].q=T[n].q||[]).push(arguments)});T[n].l=+new Date();if(T.attachEvent){T.attachEvent("onload",g)}else{T.addEventListener("load",g,false)}}(window,document,"script","tpwidget","//widget.seniverse.com/widget/chameleon.js"))</script>
					<script>tpwidget("init", {
					    "flavor": "slim",
					    "location": "WX4FBXXFKE4F",
					    "geolocation": "enabled",
					    "language": "zh-chs",
					    "unit": "c",
					    "theme": "chameleon",
					    "container": "tp-weather-widget",
					    "bubble": "disabled",
					    "alarmType": "badge",
					    "color": "#FFFFFF",
					    "uid": "U9EC08A15F",
					    "hash": "039da28f5581f4bcb5c799fb4cdfb673"
					});
					tpwidget("show");</script>
			    </div>
			    <!-- 顶部右侧菜单 -->
			    <ul class="layui-nav top_menu">

					<li class="layui-nav-item" pc>
						<a href="javascript:;">
							<img th:src="@{/static/images/face.jpeg}" class="layui-circle" width="35" height="35">
							<cite th:text="${session.userInfo.userCode}"></cite>
                           <!-- <cite><div th:text="${session.userInfo.userCode}"></div></cite>-->
                            <!--${session.userInfo.userCode}-->
						</a>
						<dl class="layui-nav-child">
							<dd><a href="javascript:;" class="changeSkin"><i class="iconfont icon-huanfu"></i><cite>更换皮肤</cite></a></dd>
							<dd><a th:href="@{/}" class="signOut"><i class="iconfont icon-loginout"></i><cite>退出</cite></a></dd>
						</dl>
					</li>
				</ul>
			</div>
		</div>
		<!-- 左侧导航 -->
		<div class="layui-side layui-bg-black">
			<div class="user-photo">
				<a class="img" title="我的头像" ><img th:src="@{/static/images/face.jpeg}"></a>
				<p>
					你好...<span id="inUserCode" class="userCode" th:text="${session.userInfo.userCode}"></span>
					<span id="inUserId" class="layui-hide" th:text="${session.userInfo.userId}"></span>
				</p>
			</div>
			<div class="navBar layui-side-scroll"></div>
		</div>
		<!-- 右侧内容 -->
		<div class="layui-body layui-form">
			<div class="layui-tab marg0" lay-filter="bodyTab" id="top_tabs_box">
				<ul class="layui-tab-title top_tab" id="top_tabs">
					<li class="layui-this" lay-id=""><i class="iconfont icon-computer"></i> <cite>后台首页</cite></li>
				</ul>
				<ul class="layui-nav closeBox">
				  <li class="layui-nav-item">
				    <a href=""><i class="iconfont icon-caozuo"></i> 页面操作</a>
				    <dl class="layui-nav-child">
					  <dd><a href="javascript:;" class="refresh refreshThis"><i class="layui-icon">&#x1002;</i> 刷新当前</a></dd>
				      <dd><a href="javascript:;" class="closePageOther"><i class="iconfont icon-prohibit"></i> 关闭其他</a></dd>
				      <dd><a href="javascript:;" class="closePageAll"><i class="iconfont icon-guanbi"></i> 关闭全部</a></dd>
				    </dl>
				  </li>
				</ul>
				<div class="layui-tab-content clildFrame">
					<div class="layui-tab-item layui-show">
						<iframe th:src="@{templates/page/main.html}"></iframe>
					</div>
				</div>
			</div>
		</div>
		<!-- 底部 -->
		<div class="layui-footer footer">
			<p>@重庆擎华信息科技有限公司</p>
		</div>
	</div>
	
	<!-- 移动导航 -->
	<div class="site-tree-mobile layui-hide"><i class="layui-icon">&#xe602;</i></div>
	<div class="site-mobile-shade"></div>
    <script th:inline="javascript" th:src="@{/static/js/jquery-3.1.1.min.js}"></script>
	<script th:inline="javascript" th:src="@{/static/layui/layui.all.js}"></script>
	<script th:inline="javascript" th:src="@{/static/js/leftNav.js}"></script>
	<script th:inline="javascript" th:src="@{/static/js/index.js}"></script>
    <script type="text/javascript">
        //自定页面加载调用
        $(document).ready(function () {
            var inUserCode = $("#inUserCode").html();
            var inUserId = $("#inUserId").html();
            //layer.msg("欢迎登陆..."+inUserCode);
			$.ajax({
                type: "POST",		//POST_GET
                url: "/ControlManager/baBhController/selAllBaBh",	//访问路径
                dataType: "json",
                success: function (data) {
                    //依据code值判定 0_有记录  -1无记录;
                    if (data.code == "0") {
                        layer.msg("欢迎登陆..."+inUserCode);
                    } else if (data.code == "-1") {
                        layer.open({
                            type: 1 //Page层类型
                            ,closeBtn :1   //关闭按钮
                            ,area: ['30%', '50%']
                            ,title: '请输入备案信息'
                            ,Boolean:false
                            ,shade: 0.6 //遮罩透明度
                            ,max: true //允许全屏最小化
                            ,anim: 0 //0-6的动画形式，-1不开启
                            ,content: '<form class="layui-form" id="FilingForm" action="page/404.html" method="post" style="margin-top: 30px;margin-left: 20px;margin-right: 50px">\n' +
                            '      <div class="layui-form-item">\n' +
                            '        <label class="layui-form-label" style="width: 110px">备案编号：</label>\n' +
                            '        <div class="layui-input-block">\n' +
                            '          <input type="text" id="filingNumber" name="filingNumber" lay-verify="title" autocomplete="off" placeholder="请输入备案编号..." class="layui-input">\n' +
                            '        </div>\n' +
                            '      </div>\n' +
                            '      <div class="layui-form-item">\n' +
                            '        <label class="layui-form-label" style="width: 110px">接口序列号：</label>\n' +
                            '        <div class="layui-input-block">\n' +
                            '          <input type="text" id="interfaceSerialNum" name="interfaceSerialNum" lay-verify="title" autocomplete="off" placeholder="请输入序列号..." class="layui-input">\n' +
                            '        </div>\n' +
                            '      </div>\n' +
                            '      <div class="layui-form-item">\n' +
                            '        <label class="layui-form-label" style="width: 110px">主备IP：</label>\n' +
                            '        <div class="layui-input-block">\n' +
                            '          <input type="text" id="activeStandbyIp" name="activeStandbyIp" lay-verify="title" autocomplete="off" placeholder="请输入主备IP..." class="layui-input">\n' +
                            '        </div>\n' +
                            '      </div>\n' +
                            '      <div class="layui-form-item">\n' +
                            '        <label class="layui-form-label" style="width: 110px">mac地址：</label>\n' +
                            '        <div class="layui-input-block">\n' +
                            '          <input type="text" id="macAddress" name="macAddress" lay-verify="title" autocomplete="off" placeholder="请输入mac地址..." class="layui-input">\n' +
                            '        </div>\n' +
                            '      </div>\n' +
                            '      <div class="layui-form-item">\n' +
                            '        <label class="layui-form-label" style="width: 110px">端口：</label>\n' +
                            '        <div class="layui-input-block">\n' +
                            '          <input type="text" id="port" name="port" lay-verify="title" autocomplete="off" placeholder="请输入端口..." class="layui-input">\n' +
                            '        </div>\n' +
                            '      </div>\n' +
                            '      <div class="layui-form-item">\n' +
                            '        <div class="layui-input-block">\n' +
                            '          <button type="reset" class="layui-btn layui-btn-primary">重置</button>\n' +
                            '          <button onclick="FilingSubmit()" type="button" class="layui-btn" >立即提交</button>\n' +
                            '        </div>\n' +
                            '      </div>\n' +
                            '    </form>'
                            ,cancel:function () {
                                layer.msg("该操作禁止关闭", {icon: 6})
                                return false    ; // 开启该代码可禁止点击该按钮关闭
                            }
                        });
                    } else {
                        layer.msg("发生某种异常,执行失败...");
                    }
                }, error: function (XMLHttpRequest, textStatus, errorThrown) {
                    layer.msg(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);              }
			});
        });

        // 自定义js中页面跳转根据参数名称获取value（定义函数）
        function getUrlParameter(paramKey) {
            var sURLVariables, i, sParameterName, sPageURL = window.location.search.substring(1);
            if (sPageURL) {
                sURLVariables = sPageURL.split("&");
                for (i = 0; i < sURLVariables.length; i++) {
                    sParameterName = sURLVariables[i].split("=");
                    if (sParameterName[0] === paramKey) return sParameterName[1]
                }
            }
        }
        //备案模态框 提交事件
        function FilingSubmit(){
            //获取参数
            var filingNumber = $("#filingNumber").val();
            var interfaceSerialNum = $("#interfaceSerialNum").val();
            var activeStandbyIp = $("#activeStandbyIp").val();
            var macAddress = $("#macAddress").val();
            var port = $("#port").val();
            if (filingNumber==""||interfaceSerialNum==""||activeStandbyIp==""||port==""||macAddress==""){
                //提示层
                layer.msg("请补全需要填写的参数...");
                $("#filingNumber").focus();
            } else {
                $.ajax({
                    type: "POST",		//POST_GET
                    url: "/ControlManager/baBhController/insBaBh",	//访问路径
                    data: {
                        "filingNumber": filingNumber
                        , "interfaceSerialNum": interfaceSerialNum
                        , "activeStandbyIp": activeStandbyIp
                        , "port": port
                        , "macAddress": macAddress
                    },
                    dataType: "json",
                    success: function (data) {
                        //依据code值判定 0_失败 1.成功;
                        if (data.code == "0") {
                            layer.msg("执行失败...");
                        } else if (data.code == "1") {
                            layer.closeAll("page");
                        } else {
                            layer.msg("发生某种异常,执行失败...");
                        }
                    }, error: function (XMLHttpRequest, textStatus, errorThrown) {
                        alert(XMLHttpRequest.readyState + XMLHttpRequest.status + XMLHttpRequest.responseText);
                        location.href = "templates/page/500";
                    }
                });
            }
        }
    </script>

</body>
</html>
